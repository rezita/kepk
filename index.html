<!DOCTYPE html>
<html>

<head>
  <style>
    body {
      background-color: black;
      image-orientation: none;
    }

    img {
      display: block;
    }

    div.toplevel {
      position: relative;
      background-color: #111;
      margin: auto;
    }

    .main {
      position: absolute;
      width: 90vw;
      height: 80vh;
      top: 5vh;
      bottom: 0;
      left: 0;
      right: 0;
      margin: 0 auto;
      z-index: 100;
    }

    .content {
      position: absolute;
      max-width: 100%;
      max-height: 100%;
      left: 0;
      right: 0;
    }

    .prev,
    .next {
      position: absolute;
      height: 70vh;
      min-width: 200px;
      top: 5vh;
      z-index: 1000;
      font-size: 300%;
      color: gray;
      margin: auto;
    }

    div.prev {
      left: 0;
    }

    div.next {
      right: 0;
    }

    div.prev span,
    div.next span {
      position: absolute;
      top: 50%;
      padding: 0px 5px;
    }

    .prev:hover,
    .next:hover {
      cursor: pointer;
    }

    div.next span {
      right: 0;
    }

    .rotate90 {
      max-width: 80vh;
      max-height: 90vw;
      transform: translatex(calc(45vw - 50%)) translatey(calc(40vh - 50%)) rotate(90deg);
    }

    .rotate180 {
      transform: rotate(180deg);
      margin: 0 auto;
    }

    .rotate270 {
      max-width: 80vh;
      max-height: 90vw;
      transform: translatex(calc(45vw - 50%)) translatey(calc(40vh - 50%)) rotate(270deg);
    }

    .rotate0 {
      margin: 0 auto;
    }
  </style>
  <script>

    function loadItem(catalog, idx) {
      let main = document.getElementById("main");
      let item = catalog[idx];
      if (item.type == "img") {
        let img = document.createElement("img");
        img.classList.add("content");
        img.src = item.src;
        let orient = item.orient
        switch (orient) {
          case 6:
            img.classList.add("rotate90");
            break;
          case 3:
            img.classList.add("rotate180");
            break;
          case 8:
            img.classList.add("rotate270");
            break;
          default:
            img.classList.add("rotate0");
        }
        main.replaceChild(img, main.childNodes[0]);
      } else if (item.type == "vid") {
        let vid = document.createElement("video");
        vid.src = item.src;
        vid.controls = true;
        vid.classList.add("content");
        vid.classList.add("rotate0");
        main.replaceChild(vid, main.childNodes[0]);
      }

      document.getElementById("prev").onclick = function () {
        if (idx == 0) {
          loadItem(catalog, catalog.length - 1);
        } else {
          loadItem(catalog, idx - 1);
        }
        return false;
      };

      document.getElementById("next").onclick = function () {
        if (idx == catalog.length - 1) {
          loadItem(catalog, 0);
        } else {
          loadItem(catalog, idx + 1);
        }
      };
    }

    function init() {
      fetch("photos.json")
        .then(function (catalog) {
          return catalog.json();
        })
        .then(function (jsonCatalog) {
          loadItem(jsonCatalog, 0);
        })
    }
  </script>
</head>

<body onload="init()">
  <div id="toplevel">
    <div id="prev" class="prev">
      <span>&lt;</span>
    </div>
    <div id="main" class="main">
      <p></p>
    </div>
    <div id="next" class="next">
      <span>&gt;</span>
    </div>
  </div>
</body>

</html>